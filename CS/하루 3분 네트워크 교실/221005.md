## 스위치

충돌 도메인 내의 컴퓨터 수가 많으면 효율이 아주 나쁜 상태가 됨

- 이더넷의 CSMA/CD는 충돌을 막는 것이 아니라 일어나기 어렵게 하는것

- 충돌 도메인 내의 컴퓨터 수가 많으면 CSMA/CD를 사용해도 결국 '2대의 컴퓨터가 동시에 송신할 가능성'이 높아짐

- 충돌이 발생하면 그 컴퓨터는 잠시 대기했다 재송신을 함

- 충돌 도메인 컴퓨터의 수가 많으면 송신-충돌-재송신-충돌 같은 일이 일어남

충돌이 발생하지 않도록 하기 위한 두가지 방법

- 신호를 보내는 타이밍이 겹치지 않도록 엇갈리게 하는 방법
- 신호가 지나는 길을 나누는 방법
  - 스위치

스위치

- 허브 대신에 사용
- 허브와 마찬가지로 복수의 컴퓨터를 연결
  - 복수의 포트를 가지고 있음

컴퓨터를 스위치에 연결함으로써 다른 컴퓨터와의 사이에서 신호를 송수신할 수 있게 됨

- 허브를 그냥 스위치로 치환만 하면 됨

충돌은 허브에서 발생하는 것

- LAN에서 사용되고 있는 UTP나 광파이버 케이블은 '송신 신호'와 '수신 신호'가 나뉘어져 있음
- 케이블상에서는 신호가 동시에 지나가도 충돌은 발생하지 않는 다는 것
- 허브가 동시에 2개 이상의 기기로부터 신호를 수신하면 허브를 그것을 나누어서 보낼 수 없음
- 여기서 충돌이 발생

### MAC 주소 필터링

스위치 안에서 수신한 프레임을 따로따로 보낼 수 있도록 처리해서 충돌을 막음

- MAC 주소 필터링
- 버퍼링

MAC 주소 필터링

- 학습
- 스위칭

#### 학습

수신한 프레임의 송신처 MAC 주소를 기록

이것으로 수신한 포트랑 MAC 주소를 연관 짓는 것

어드레스 테이블

- 학습에 의해 스위치는 포트에 연결되어 있는 컴퓨터의 MAC 주소를 기억하는 대응표

#### 스위칭

프레임의 수신처 MAC 주소를 보고 그 MAC 주소가 있는 포트만 프레임을 송신

수신처 MAC 주소가 있는 포트를 알 수 있는 방법

- 아까 학습한 어드레스 테이블 

이 결과 수신처가 다른 프레임이 동시에 스위치에 도달해도 충돌은 발생하지 않게 됨

- 허브는 어떤 프레임이 도달해도 플로딩
- 스위치는 그런 일이 일어나지 않음
- 예) A에서 B로, 그리고 C에서 D로 스위치에 도달했다고 해도 B 수신은 B가 연결되어 있는 포트만, D 수신은 D가 연결되어 있는 포트만 송신하니까 충돌하지 않음

MAC 주소에 의해 송신하는 포트를 필터일하기 때문에 MAC 주소 필터링이라고 함

#### 주의할 점

스위치는 먼저 주소를 '학습'하고 포트와 MAC의 대응표인 어드레스 테이블을 만들어야 한다

- MAC 주소가 송신처의 프레임을 수신하기 전이여서 학습하지 않은 상태라면 MAC 주소 필터링을 할 수 없음

허브와 마찬가지로 플러딩함

- 학습전의 MAC 주소 수신의 프레임을 수신한 경우
- 수신처가 1대가 아닌 멀티캐스트와 브로드캐스트 수신처인 프레임을 수신한 경우

버퍼링이 나와야 하는 이유

## 전이중 이더넷

### 버퍼링

스위치 : 수신처가 다른 프레임이 동시에 스위치에 도달해도 충돌을 일으키지 않게 함

버퍼링 : 수신처가 같은 프레임이 동시에 스위치에 도달하면 어떻게 되는가

버퍼링

- 버퍼(Buffer)를 사용한 처리를 실행하는 것
  - 버퍼: 일시적으로 데이터를 기록해 둘 수 있는 기억기기(메모리)

충돌할 것 같은 프레임을 일시적으로 저장

- 수신처가 같은 프레임이 두 개 도달했을 경우 한 개는 송신하고 나머지 한 개는 일시적으로 버퍼에 저장
- 첫 번째 프레임 송신이 끝나면 저장해 두었던 프레임을 송신시킴

문제

- 버퍼의 용량: 수신처가 같은 프레임이 계속해서 올 경우 버퍼에 저장할 수는 있지만 무한대로 저장할 수 없음
  - 기억기기의 용량은 제한되어 있음

규격을 사용해서 송신을 조정

- 버퍼가 가득 찬 경우 충돌을 전하는 신호 또는 PAUSE 프레임에 의해 더 이상의 송신을 중단시킨다

- 백 프레셔(Back Pressure)
  - 버퍼 용량 초과 직전
  - 계속 송신(반이중)
  - JAM 신호(충돌을 알림)를 송신
  - 충돌이 일어났다고 판단해 송신을 중지
- IEEE802.3
  - 버퍼 용량 초과 직전
  - 계속 송신(전이중)
  - PAUSE 프레임이라는 IEEE802.3x 전용 프레임을 송신
  - PAUSE 프레임에 의해 일시적으로 송신 중지
- 버퍼가 부족할 것 같다고 판단하면 송신을 중지

스위치를 사용해서 충돌이 일어나지 않게 함

- MAC 주소 필터링
- 버퍼링
- 충돌 도메인은 스위치에 의해 분할
  - 충돌 도메인 : 그 범위에 있는 기기에서 충돌 가능성이 있다
  - 스위치를 사용하면 충돌이 발생하지 않게 됨
  - 충돌 도메인은 작아야 하는데 스위치가 이것을 실현해서 데이터 통신의 효율을 높이는 것

### 전이중 이더넷

이더넷에서는 충돌을 방지하기 위해 CSMD/CD를 사용

스위치 덕분에 충돌이 발생하지 않는다면 CSMD/CD는 필요 없어짐

반이중 통신(Half-Duplex)

- 누군가가 송신중(자기는 수신 중)일 떄는 데이터를 송신하지 않는다
- 자기가 송신 중일 때는 충돌을 막기 위해 다른 컴퓨터가 송신해 오지 않는다 즉, 수신하지 않는다
- CSMA/CD는 반이중 통신

전이중 통신(Full-Duplex)

- 동시에 송신과 수신을 할 수 있는 방식
- 스위치를 사용한 경우엔 충돌을 염려할 필요가 없으니까 CSMA/CD를 사용할 필요가 없음

전이중 이더넷

- 스위치를 사용해 전이중 통신을 하는 것

예) 5대의 컴퓨터가 허브에 연결되어 있고 케이블이 100Mbps, 5대의 컴퓨터가 각각 100Mbps의 데이터를 송신하고 싶은 경우

- 허브에는 동시에 송신할 수 없음
  - 1대가 100Mbps를 송신한 후에 다음 컴퓨터가 보내고 또 다음 컴퓨터가 보내는 반복
  - 결과적으로 1대당 20Mbps
- 전이중 이더넷이라면 동시의 송신과 수신이 가능
  - 1대당 100Mbps를 사용 가능