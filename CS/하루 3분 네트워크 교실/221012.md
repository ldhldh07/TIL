## ARP

### 주소해결 프로토콜

- 수신처 MAC 주소
  - 수신처의 IP 주소가 결정된 후에 정해짐
    - ARP(Address Resolution Protocol)
- 송신처 MAC 주소
- 수신처 IP 주소
- 송신처 IP 주소

#### ARP

주소 해결 프로토콜

- 이 IP 주소의 호스트님, 당신의 MAC 주소를 알려주세요라고 질문하는 프로토콜
- 이걸로 'MAC 주소를 모르는' 상태를 '해결'하는 프로토콜

### ARP 테이블과 ARP

데이터를 전송하고 싶은 컴퓨터는 수신처의 IP 주소를 결정하고, 그 후에 수신처 MAC 주소를 알기 위해서 ARP 테이블을 참조

#### ARP 테이블

IP 주소와 MAC 주소의 대응표

IP 주소의 컴퓨터 주소는 이것이다

- 예) 192.168.0.1의 MAC 주소는 00-40-26-f4-1a-02입니다

ARP 테이블의 수신처 IP와 MAC 주소의 대응이 있으면 그 시점에서 수신처 MAC 주소를 알 수 있음

#### ARP 요청

ARP 테이블에 수신처 IP 주소와 MAC 주소의 대응이 없는 경우에는 수신처 MAC 주소를 모름

ARP를 사용해서 묻고 그 결과를 ARP 테이블에 기재

이 알려달라는 동작을 ARP 요청이라고 부름

브로드캐스트로 네트워크 내의 모든 컴퓨터에 송신

#### ARP 응답

알려달라라고  요청받았기 떄문에 자신의 MAC 주소가 이것이라고 응답

ARP 응답을 받은 컴퓨터, 즉 ARP 요청을 송신한 측의 컴퓨터는 ARP의 결과를 ARP 테이블에 기재

수신처의 MAC 주소가 결정됨



#### ARP의 동작

브로드캐스트로 ARP 요청을 보내고 대응하는 컴퓨터만 응답한다

1. 송신을 원하는 컴퓨터는 먼저 자신의 ARP 테이블을 참조한다
2. ARP 테이블에 수신처 IP 주소가 없을 경우 ARP 요청을 브로드캐스트한다
3. ARP 요청의 수신처를 확인하고 자신인 경우에는 응답한다. 그렇지 않은 경우는 파기한다
4. ARP 응답을 받으면 ARP 테이블에 응답 결과를 추가로 기술한다

#### ARP 파기

ARP 테이블에 기재되어 있는 IP 주소와 MAC 주소의 대응은 일정 기간이 지나면 파기됨

수동으로 IP 주소와 MAC 주소의 대응을 ARP 테이블에 설정한다면 사라질 일은 없지만 일반적으로 그렇게 하지는 않는다

인터페이스 고장 등으로 MAC 주소가 변경되어도 대응할 수 있도록 하기 위해

- ARP를 통해서 IP 주소에 대응한 MAC 주소를 받은 후에 인터페이스가 고장난다면 MAC 주소는 변경된다

- IP 주소는 인터페이스가 고장나서 교환해도 변경되지 않는다

- IP는 전 주소 그대로고 MAC 주소는 새로운 값이 되는것

- ARP 테이블에 기재되어 있는 IP 주소와 MAC 주소의 대응은 일치하지 않게 됨

틀린 MAC 주소로 데이터를 보내면 데이터가 도달하지 않게 됨

그래서 ARP 테이블을 파기함

## DNS

### 수신처 IP 주소를 안다

- 수신처 MAC 주소
- 송신처 MAC 주소
- 수신처 IP 주소
  - 가장 간단한 방법
    - 데이터 전송을 원하는 애플리케이션이나 사용자가 수신처의 IP 주소를 알고 있는 경우
    - 숫자를 잘 못외움
  - 도메인 명(Domain Name) 사용
- 송신처 IP 주소

### DNS

도메인 명은 송신할 상대의 컴퓨터 이름

외우기 쉽도록 영문과 숫자로 구성되며 가장 좋은 예는 WWW로 사용되고 있는 http://의 뒤에 오는 문자열

다른 컴퓨터와 구별해야 하기 때문에 유일한 이름이여야 한다

- IP 주소와 마찬가지로 ICANN이 관리

도메인 명으로 송신하고 싶은 상대를 간단하게 기억할 수 있도록 되어 있다

IP 주소를 직접 기억하는 것은 어려우니까 이름을 붙임

문제

- 역시 데이터 통신에는IP 주소가 필요

#### DNS(Domain Name System)

이름과 IP 주소를 대응시킨 시스템

1. 사용자 애플리케이션은 도메인 명으로 수신처를 지정
2. 그 도메인 명에 대응하는 IP 주소를 문의한다
3. DNS 서버는 문의한 도메인 명에 대응한 IP 주소를 데이터베이스에서 찾는다
4. 도메인 명에 대응한 IP 주소를 응답한다

#### DNS 서버

이름과 IP 주소의 대응 데이터베이스를 가지고 있음

DNS 서버에 문의해서 수신처의 IP 주소를 입수

DNS 서버는 각 조직에 1개씩 있고 그 조직의 도메인 명만 관리

다른 조직의 호스트 명과 도메인 명 

- 그 조직의 DNS 서버에 물음

1. 사용자 애플리케이션은 도메인 명으로 수신처를 지정
   - `www.3min.net`와 데이터를 송수힌하고 싶다
2. 그 도메인 명에 대응하는 IP 주소를 문의한다
   - `www.3min.net` IP 주소를 알려줘?
3. 다른 조직의 도메인 명은 그 조직의 서버에 문의한다.
   - 다른 조직의 도메인 명은 그 조직의 서버에 물어보자
4. 도메인 명에 대응한 IP 주소를 입수한다
   - 200.100.10.1이에요
5. 입수한 IP 주소를 DNS 서버 `www.3min.net`에 가르쳐준다

DNS란 전 세계의 도메인 명 · 호스트 명을 관리하는 일종의 분산형 데이터베이스

- 여러 이름의 데이터베이스가 여기저기에 분상되어 있기 때문

### 4개의 주소 · 완결편

송신처의 주소

- MAC 주소는 NIC를 설치하면 자동적으로 알 수 있음

송신처의IP 주소

- 수동 또는 DHCP로 할당 받아서 알 수 있다

수신처 IP 주소

- 사용자 혹은 애플리케이션이 수신처의 도메인 명을 결정하면 DNS로 수신처 IP 주소를 알 수 있다

수신처 MAC 주소

- 수신처 IP 주소를 알면 ARP로 수신처 MAC 주소를 알 수 있다

데이터 전송이 가능해진다

DHCP, ARP, DNS를 사용하여 4개의 주소를 결정한다

1. 자신의 IP 주소는 수동 또는 DHCP에서 할당 받고, MAC 주소는 자동적으로 안다.
2. 사용자 애플리케이션이 수신처의 도메인 명을 결정하면 DNS로 IP 주소를 취득한다
3. IP 주소가 결정된 후 ARP에 의해 MAC 주소를 취득한다
4. 이것으로 송신처, 수신처의MAC 주소, IP주소를 알았기 때문에 데이터 전송이 가능해진다.
